\chapter{Технологическая часть}



\section{Обзор in-memory СУБД}

\subsection{Memcached}

Memcached - это высокопроизводительная система кэширования данных в оперативной памяти, предназначенная для использования в ускорении динамических веб-приложений за счет уменьшения нагрузки на базу данных. Memcached относится к семейству решений для управления данными NoSQL и основана на модели данных с ключевыми значениями  \cite{memcash}. 

Данная СУБД спроектирована так, чтобы все операции имели алгоритмическую сложность O(1), то есть время выполнения любой операции не зависит от количества хранящихся ключей. Это означает, что некоторые операции или возможности, реализация которых требует всего лишь линейного (O(n)) времени, в ней отсутствуют. Так, например, в Memcached отсутствует возможность группировки ключей.


Memcached не является надежным хранилищем – возможна ситуация, когда ключ будет удален из кэша раньше окончания его срока жизни. 

Управление внутренней памятью Memcached более эффективно в простейших случаях использования (при кэшировании относительно небольших и статических данных), поскольку оно потребляет сравнительно мало ресурсов памяти для метаданных. Строки (единственный тип данных, поддерживаемый Memcached) идеально подходят для хранения данных, которые только читаются, потому что строки не требуют дальнейшей обработки. Тем не менее, эффективность управления памятью Memcached быстро уменьшается, когда размер данных является динамическим, после чего память Memcached может стать фрагментированной \cite{memcash2}. 

Еще одно преимущество Memcached -- достаточно простая масштабируемость: поскольку данная система многопоточна, ее можно увеличить, просто предоставив больше вычислительных ресурсов. Однако это может привести к потере части или всех кэшированных данных (в зависимости от того, используется ли постоянное хеширование). \\

\subsection{Redis}


Redis \cite{redis} -- резидентная система управлениями базами данных класса NoSQL с открытым исходным кодом. 

Основной структурой данных, с которой работает Redis является структура типа <<ключ-значение>>, причем значения могут быть пяти различных типов. Данная СУБД используется как для хранения данных, так и для реализации кэшей и брокеров сообщений.

Redis хранит данные в оперативной памяти и снабжена механизмом <<снимков>> и журналирования, что обеспечивает постоянное хранение данных. Существует поддержка репликации данных типа master-slave, транзакций и пакетной обработки комманд.

Redis позволяет осуществлять мелкомасштабный контроль за вытеснением данных, предоставляя выбор из шести различных политик вытеснения \cite{redis2}. 

К недостаткам Redis можно отнести отсутствие вторичных индексов и триггеров. Также транзакции в данной СУБД не удовлетворяют свойствам ACID (Atomicity -- Атомарность, Consistency -- Согласованность, Isolation -- Изолированность, Durability -- Долговечность) \cite{acid}.\\


\subsection{Tarantool}


Tarantool \cite{tarantool} -- это платформа in-memory вычислений с гибкой схемой хранения данных для эффективного создания высоконагруженных приложений. Включает себя базу данных и сервер приложений на языке программирования Lua \cite{lua}.

Записи в Tarantool хранятся в пространствах (space) -- аналог таблицы в реляционной базе данных SQL. Внутри пространства находятся кортежи (tuples), которые похожи на строку в таблице SQL. 


Tarantool объединяет в себе преимущества, характерные для кэша:
\begin{itemize}
	\item <<горячие данные>>;
	\item оптимальная работа при высокой параллельной нагрузке;
	\item низкая задержка (99\% запросов < 1 мс, 99,9\% запросов < 3 мс);
	\item поддерживаемая загрузка на запись — до 1 миллиона транзакций в секунду на одном ядре ЦПУ;
	\item система работает постоянно, не нужно делать перерыв на профилактические работы,
\end{itemize}
и достоинства классических СУБД:
\begin{itemize}
	\item персистентность;
	\item транзакции со свойствами ACID;
	\item наличие репликации (master-slave и master-master);
	\item наличие хранимых процедуры.
	\item поддержка первичных и вторичных индексов (в том числе, составных).
\end{itemize}


В Tarantool реализован механизм <<снимков>> текущего состояния хранилища и журналирования всех операций, что позволяет восстановить состояние базы данных после ее перезагрузки.

К недостаткам данной СУБД можно отнести относительно малое количество поддерживаемых языков (C, C\#, C++, Erlang, Go, Java, JavaScript, Lua, Perl, PHP, Python, Rust) \cite{tarantool}, а также более высокий порог входа по сравнению с ранее рассмотренными СУБД \cite{redis2}.


\subsection{Выбор СУБД для решения задачи}

В данной работе не предполагается хранение в БД очень большого количества информации, и в этом случае требованию о коротком времени отклика удовлетворяют все рассмотренные СУБД.

Для удобного хранения данных, указанных в пункте \ref{data}, СУБД должна предоставлять несколько типов данных, таких как строки, целые числа, числа с плавающей запятой. Этому требованию не удовлетворяет Memcached.

Для того, чтобы предоставить пользователям перечисленные в пункте \ref{functions} функции, в СУБД должна быть реализована возможность создания вторичных индексов, а также триггеров или хранимых процедур (для выполнения сложных вычислений). Данному требованию не удовлетворяет Redis.

При этом необходимо надежное хранение данных, без риска их потери даже в случае сбоя в системе, а также реализация ACID транзакций. 

Всем перечисленным требованиям удовлетворяет Tarantool, поэтому именно эта СУБД была выбрана для использования в данной работе.
